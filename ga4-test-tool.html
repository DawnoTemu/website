<!DOCTYPE html>
<html lang="pl">
<head>
    <!-- Google Consent Mode v2 – defaults (everything denied except security) -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
    
        /*  Default state: no data until the visitor decides  */
        gtag('consent', 'default', {
        ad_storage:            'denied',
        ad_user_data:          'denied',      // v2 field
        ad_personalization:    'denied',      // v2 field
        analytics_storage:     'denied',
        functionality_storage: 'denied',
        personalization_storage:'denied',
        security_storage:      'granted',     // must stay granted
        url_passthrough:       true           // preserve UTMs through redirects
        });
        
        // Enhanced logging for testing
        console.log('🧪 GA4 Test Tool - Consent Mode v2 initialized');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GA4 Testing Tool - DawnoTemu</title>

    <link rel="stylesheet" href="/styles/icons.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/scripts/tailwind-config.js"></script>
    <link rel="stylesheet" href="/styles/styles.css">
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-W5WXGDM9');</script>
    <!-- End Google Tag Manager -->
    
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0;
            background: #f5f5f5; 
        }
        main.ga4-tool {
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        .tool-card { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            margin: 20px 0; 
        }
        h1 { color: #333; }
        h2 { color: #666; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .test-section { margin: 20px 0; }
        .button { 
            background: #007cba; 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px; 
            font-size: 14px;
        }
        .button:hover { background: #005a87; }
        .button.secondary { background: #666; }
        .button.secondary:hover { background: #444; }
        .status { 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px; 
            font-family: monospace; 
            font-size: 12px;
        }
        .status.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .status.info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .log-output { 
            background: #f8f9fa; 
            border: 1px solid #dee2e6; 
            border-radius: 5px; 
            padding: 15px; 
            font-family: monospace; 
            font-size: 12px; 
            max-height: 300px; 
            overflow-y: auto; 
            white-space: pre-wrap;
        }
        .utm-input { 
            width: 100%; 
            max-width: 600px; 
            padding: 8px; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
            font-family: monospace;
        }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W5WXGDM9"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <header class="site-header bg-white py-3 sm:py-5 fixed top-0 left-0 w-full z-50 shadow-sm-custom backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-5 sm:px-6 md:px-8 relative">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <a href="/" class="flex items-center nav-brand">
                        <h1><img src="/images/logo.png" alt="DawnoTemu Logo" class="h-8 sm:h-10 mr-2 sm:mr-3" loading="lazy"></h1>
                    </a>
                </div>
                
                <nav class="hidden md:flex items-center space-x-8">
                    <a href="/" id="nav-home" class="nav-link text-text-medium hover:text-text-dark transition-colors">Strona główna</a>
                    <a href="/o-nas" id="nav-about" class="nav-link text-text-medium hover:text-text-dark transition-colors">O nas</a>
                    <a href="/biblioteka" id="nav-library" class="nav-link text-text-medium hover:text-text-dark transition-colors">Biblioteka bajek</a>
                    <a href="/kontakt" id="nav-contact" class="nav-link text-text-medium hover:text-text-dark transition-colors">Kontakt</a>
                    <a href="/punkty-magii" id="nav-credits" class="nav-link text-text-medium hover:text-text-dark transition-colors">Punkty Magii</a>
                    <a href="/punkty-magii#cta" class="nav-cta bg-peach text-white py-2.5 px-5 rounded-full font-semibold transition duration-300 ease-in-out border-none cursor-pointer text-sm shadow-md hover:bg-peach-dark hover:-translate-y-0.5 hover:shadow-lg">Wypróbuj za darmo</a>
                </nav>
                
                <div class="mobile-menu-toggle flex flex-col justify-between w-[24px] sm:w-[30px] h-[18px] sm:h-[21px] cursor-pointer md:hidden" id="mobile-menu-toggle" aria-label="Toggle mobile menu" aria-expanded="false">
                    <span class="w-full h-[2px] sm:h-[3px] bg-text-dark rounded transition duration-300"></span>
                    <span class="w-full h-[2px] sm:h-[3px] bg-text-dark rounded transition duration-300"></span>
                    <span class="w-full h-[2px] sm:h-[3px] bg-text-dark rounded transition duration-300"></span>
                </div>
            </div>
        </div>
    </header>
    
    <div id="mobile-nav-overlay" class="fixed inset-0 bg-text-dark/50 z-30 hidden opacity-0 transition-opacity duration-300"></div>

    <div class="mobile-nav-container fixed top-[57px] sm:top-[71px] right-0 h-[calc(100vh-57px)] sm:h-[calc(100vh-71px)] bg-white z-40 p-5 sm:p-8 flex-col hidden transform translate-x-full transition-transform duration-300 ease-in-out shadow-xl" id="mobile-nav">
        <div class="flex flex-col h-full overflow-y-auto">
            <div class="flex items-center mb-6 sm:mb-8">
                <img src="/images/logo.png" alt="DawnoTemu Logo" class="h-8 mr-2" loading="lazy">
            </div>
            
            <nav class="flex flex-col gap-4 sm:gap-5">
                <a href="/" id="nav-home" class="mobile-nav-link nav-link text-text-dark text-lg font-medium py-1 flex items-center">
                    <span class="mr-3 w-5 text-center opacity-70"><i class="fas fa-home"></i></span>
                    Strona główna
                </a>
                
                <a href="/o-nas" id="nav-about" class="mobile-nav-link nav-link text-text-dark text-lg font-medium py-1 flex items-center">
                    <span class="mr-3 w-5 text-center opacity-70"><i class="fas fa-info-circle"></i></span>
                    O nas
                </a>
                
                <a href="/biblioteka" id="nav-library" class="mobile-nav-link nav-link text-text-dark text-lg font-medium py-1 flex items-center">
                    <span class="mr-3 w-5 text-center opacity-70"><i class="fas fa-book"></i></span>
                    Biblioteka bajek
                </a>
                
                <a href="/kontakt" id="nav-contact" class="mobile-nav-link nav-link text-text-dark text-lg font-medium py-1 flex items-center">
                    <span class="mr-3 w-5 text-center opacity-70"><i class="fas fa-envelope"></i></span>
                    Kontakt
                </a>

                <a href="/punkty-magii" id="nav-credits" class="mobile-nav-link nav-link text-text-dark text-lg font-medium py-1 flex items-center">
                    <span class="mr-3 w-5 text-center opacity-70"><i class="fas fa-wand-magic-sparkles"></i></span>
                    Punkty Magii
                </a>
            </nav>
            
            <a href="/punkty-magii#cta" class="mt-8 bg-peach text-white py-3 sm:py-4 px-6 rounded-full font-semibold transition duration-300 ease-in-out border-none cursor-pointer text-base sm:text-base shadow-md text-center hover:bg-peach-dark">
                Wypróbuj za darmo
            </a>
        </div>
    </div>

    <main class="ga4-tool pt-28 md:pt-36">
    
    <div class="tool-card">
        <h1>🧪 GA4 Testing Tool - DawnoTemu</h1>
        <div class="status info">
            <strong>Container ID:</strong> GTM-W5WXGDM9<br>
            <strong>Testing Mode:</strong> Local Development<br>
            <strong>Page Load:</strong> <span id="loadTime"></span>
        </div>
    </div>

    <div class="grid">
        <div class="tool-card">
            <h2>1. Consent Testing</h2>
            <div class="test-section">
                <p>Test different consent scenarios and verify GA4 events:</p>
                <button class="button" onclick="testConsentAll()">Accept All Cookies</button>
                <button class="button secondary" onclick="testConsentAnalyticsOnly()">Analytics Only</button>
                <button class="button secondary" onclick="testConsentNone()">Reject All</button>
                <button class="button secondary" onclick="checkConsentStatus()">Check Current Consent</button>
                <div id="consentStatus" class="log-output" style="height: 150px;"></div>
            </div>
        </div>

        <div class="tool-card">
            <h2>2. UTM Parameter Testing</h2>
            <div class="test-section">
                <p>Test Meta ads UTM parameters:</p>
                <input type="text" class="utm-input" id="utmInput" 
                       placeholder="Enter UTM parameters (e.g., utm_source=facebook&utm_medium=cpc&utm_campaign=test)"
                       value="utm_source=facebook&utm_medium=cpc&utm_campaign=test_campaign&utm_content=test_ad&fbclid=test123456">
                <br><br>
                <button class="button" onclick="testUTMs()">Load Page with UTMs</button>
                <button class="button secondary" onclick="clearUTMs()">Clear UTMs</button>
                <div id="utmStatus" class="log-output" style="height: 150px;"></div>
            </div>
        </div>
    </div>

    <div class="tool-card">
        <h2>3. GA4 DataLayer Monitoring</h2>
        <div class="test-section">
            <p>Monitor GTM dataLayer events in real-time:</p>
            <button class="button" onclick="startDataLayerMonitoring()">Start Monitoring</button>
            <button class="button secondary" onclick="stopDataLayerMonitoring()">Stop Monitoring</button>
            <button class="button secondary" onclick="clearDataLayerLog()">Clear Log</button>
            <button class="button secondary" onclick="sendTestEvent()">Send Test Event</button>
            <div id="dataLayerLog" class="log-output"></div>
        </div>
    </div>

    <div class="tool-card">
        <h2>4. GA4 DebugView Setup</h2>
        <div class="test-section">
            <div class="status info">
                <strong>To test with GA4 DebugView:</strong><br>
                1. Add <code>?debug_mode=true</code> to any URL<br>
                2. Open GA4 → Configure → DebugView<br>
                3. Perform actions and verify events fire<br>
                4. Look for: page_view, session_start, consent_accepted, utm_parameters_detected
            </div>
            <button class="button" onclick="enableDebugMode()">Enable Debug Mode</button>
            <button class="button secondary" onclick="openGA4DebugView()">Open GA4 DebugView</button>
        </div>
    </div>

    <div class="tool-card">
        <h2>5. Test Results Summary</h2>
        <div id="testResults" class="log-output"></div>
    </div>

    </main>

    <footer class="site-footer bg-gradient-to-r from-text-dark to-text-dark/95 text-white pt-20 pb-8 relative">
        <div class="absolute top-0 left-0 w-full overflow-hidden" style="transform: translateY(-99%)">
            <svg preserveAspectRatio="none" width="100%" height="50" viewBox="0 0 1440 74" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M0,37.7L48,42.5C96,47.3,192,57,288,56C384,55,480,43.3,576,49.7C672,56,768,80.3,864,84.8C960,89.3,1056,74,1152,58C1248,42,1344,25.3,1392,17L1440,8.7L1440,37.7L1392,37.7C1344,37.7,1248,37.7,1152,37.7C1056,37.7,960,37.7,864,37.7C768,37.7,672,37.7,576,37.7C480,37.7,384,37.7,288,37.7C192,37.7,96,37.7,48,37.7L0,37.7Z" fill="#FFFFFF"/>
            </svg>
        </div>
        <div class="max-w-7xl mx-auto px-8">
            <div class="grid grid-cols-1 md:grid-cols-7 gap-12 mb-12">
                <div class="md:col-span-2 flex flex-col">
                    <div class="flex items-center mb-6">
                        <img src="/images/logo-light.png" alt="DawnoTemu Logo" class="h-10 mr-3" loading="lazy">
                    </div>
                    <p class="text-white/70 text-sm mb-6 leading-relaxed">
                        DawnoTemu pomaga rodzicom utrzymać magię wieczornych bajek — nawet gdy nie mogą być obok. Twój głos, ich ulubione historie.
                    </p>
                    <div class="flex gap-4 mb-8">
                        <a href="https://www.facebook.com/dawnotemuapp" target="_blank" class="group flex items-center justify-center w-10 h-10 bg-white/10 rounded-full transition-all duration-300 hover:bg-peach hover:scale-110 hover:shadow-[0_0_15px_rgba(251,190,159,0.5)]">
                            <i class="fab fa-facebook-f group-hover:animate-bounce-mini"></i>
                        </a>
                        <a href="https://www.instagram.com/dawnotemu.app" target="_blank" class="group flex items-center justify-center w-10 h-10 bg-white/10 rounded-full transition-all duration-300 hover:bg-peach hover:scale-110 hover:shadow-[0_0_15px_rgba(251,190,159,0.5)]">
                            <i class="fab fa-instagram group-hover:animate-bounce-mini"></i>
                        </a>
                        <a href="https://www.tiktok.com/@dawnotemuapp" target="_blank" class="group flex items-center justify-center w-10 h-10 bg-white/10 rounded-full transition-all duration-300 hover:bg-peach hover:scale-110 hover:shadow-[0_0_15px_rgba(251,190,159,0.5)]">
                            <i class="fab fa-tiktok group-hover:animate-bounce-mini"></i>
                        </a>
                    </div>
                </div>
                
                <div class="md:col-span-1">
                    <h5 class="text-xl mb-6 font-semibold text-white relative inline-block">
                        Aplikacja
                        <span class="absolute left-0 bottom-0 w-1/2 h-0.5 bg-gradient-to-r from-peach to-lavender"></span>
                    </h5>
                    <ul class="list-none space-y-3">
                        <li><a href="/#features" class="text-white/70 hover:text-white transition-colors duration-300 inline-block">Funkcje</a></li>
                        <li><a href="/#how-it-works" class="text-white/70 hover:text-white transition-colors duration-300 inline-block">Jak to działa</a></li>
                        <li><a href="/biblioteka" class="text-white/70 hover:text-white transition-colors duration-300 inline-block">Biblioteka bajek</a></li>
                        <li><a href="/#faq" class="text-white/70 hover:text-white transition-colors duration-300 inline-block">FAQ</a></li>
                    </ul>
                </div>
                
                <div class="md:col-span-1">
                    <h5 class="text-xl mb-6 font-semibold text-white relative inline-block">
                        Firma
                        <span class="absolute left-0 bottom-0 w-1/2 h-0.5 bg-gradient-to-r from-peach to-lavender"></span>
                    </h5>
                    <ul class="list-none space-y-3">
                        <li><a href="/o-nas" class="text-white/70 hover:text-white transition-colors duration-300 inline-block">O nas</a></li>
                        <li><a href="/kontakt" class="text-white/70 hover:text-white transition-colors duration-300 inline-block">Kontakt</a></li>
                        <li><a href="/punkty-magii" class="text-white/70 hover:text-white transition-colors duration-300 inline-block">Punkty Magii</a></li>
                        <li><a href="/polityka-prywatnosci" class="text-white/70 hover:text-white transition-colors duration-300 inline-block">Polityka prywatności</a></li>
                    </ul>
                </div>
                
                <div class="md:col-span-1">
                    <h5 class="text-xl mb-6 font-semibold text-white relative inline-block">
                        Materiały
                        <span class="absolute left-0 bottom-0 w-1/2 h-0.5 bg-gradient-to-r from-peach to-lavender"></span>
                    </h5>
                    <ul class="list-none space-y-3">
                        <li><a href="/files/polityka-prywatnosci-i-cookies.pdf" class="text-white/70 hover:text-white transition-colors duration-300 inline-block" target="_blank" rel="noopener">Polityka cookies</a></li>
                        <li><a href="/files/polityka-bezpieczenstwa.pdf" class="text-white/70 hover:text-white transition-colors duration-300 inline-block" target="_blank" rel="noopener">Bezpieczeństwo danych</a></li>
                        <li><a href="/files/polityka-ochrony-danych.pdf" class="text-white/70 hover:text-white transition-colors duration-300 inline-block" target="_blank" rel="noopener">Ochrona danych</a></li>
                        <li><a href="/files/zgoda-na-matkering-bezpisredni-newsletter.pdf" class="text-white/70 hover:text-white transition-colors duration-300 inline-block" target="_blank" rel="noopener">Zgoda marketingowa</a></li>
                    </ul>
                </div>
                
                <div class="md:col-span-2">
                    <h5 class="text-xl mb-6 font-semibold text-white relative inline-block">
                        Bądź na bieżąco
                        <span class="absolute left-0 bottom-0 w-1/2 h-0.5 bg-gradient-to-r from-peach to-lavender"></span>
                    </h5>
                    <p class="text-white/70 mb-4">
                        Dołącz do listy zainteresowanych subskrypcją Punkty Magii i otrzymuj wiadomości o premierach nowych funkcji.
                    </p>
                    <form class="flex flex-col sm:flex-row gap-4">
                        <input type="email" class="px-5 py-3 rounded-full bg-white/10 border border-white/20 placeholder:text-white/60 text-white focus:outline-none focus:border-peach" placeholder="Twój adres e-mail">
                        <button type="submit" class="px-6 py-3 rounded-full bg-peach text-text-dark font-semibold shadow-md hover:bg-white transition">
                            Zapisz się
                        </button>
                    </form>
                </div>
            </div>
            <div class="border-t border-white/10 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-white/60 text-sm">© 2025 DawnoTemu Sp. z o.o. Wszelkie prawa zastrzeżone.</p>
                <div class="flex gap-6 text-white/60 text-sm">
                    <a href="/polityka-prywatnosci" class="hover:text-white transition">Polityka prywatności</a>
                    <a href="/kontakt" class="hover:text-white transition">Kontakt</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="/scripts/main.js"></script>
    <script>
        // Test tool specific JavaScript
        let dataLayerMonitor = null;
        let originalDataLayer = [];
        
        // Page load time
        document.getElementById('loadTime').textContent = new Date().toLocaleTimeString();
        
        // Store original dataLayer for monitoring
        if (window.dataLayer) {
            originalDataLayer = [...window.dataLayer];
        }
        
        // Consent Testing Functions
        function testConsentAll() {
            gtag('consent', 'update', {
                ad_storage: 'granted',
                analytics_storage: 'granted',
                ad_user_data: 'granted',
                ad_personalization: 'granted',
                personalization_storage: 'granted',
                functionality_storage: 'granted'
            });
            
            gtag('event', 'consent_accepted', {
                consent_type: 'all',
                custom_parameter: 'test_mode'
            });
            
            updateConsentStatus('✅ All cookies accepted - Full tracking enabled');
        }
        
        function testConsentAnalyticsOnly() {
            gtag('consent', 'update', {
                ad_storage: 'denied',
                analytics_storage: 'granted',
                ad_user_data: 'denied',
                ad_personalization: 'denied',
                personalization_storage: 'denied',
                functionality_storage: 'granted'
            });
            
            gtag('event', 'consent_accepted', {
                consent_type: 'analytics_only',
                custom_parameter: 'test_mode'
            });
            
            updateConsentStatus('⚠️ Analytics only - Limited tracking');
        }
        
        function testConsentNone() {
            gtag('consent', 'update', {
                ad_storage: 'denied',
                analytics_storage: 'denied',
                ad_user_data: 'denied',
                ad_personalization: 'denied',
                personalization_storage: 'denied',
                functionality_storage: 'denied'
            });
            
            updateConsentStatus('❌ All cookies rejected - Cookieless tracking only');
        }
        
        function checkConsentStatus() {
            const status = `Current consent status checked at ${new Date().toLocaleTimeString()}\\nCheck browser console for detailed consent state`;
            updateConsentStatus(status);
        }
        
        function updateConsentStatus(message) {
            const statusDiv = document.getElementById('consentStatus');
            statusDiv.textContent += `[${new Date().toLocaleTimeString()}] ${message}\\n`;
            statusDiv.scrollTop = statusDiv.scrollHeight;
        }
        
        // UTM Testing Functions
        function testUTMs() {
            const utmParams = document.getElementById('utmInput').value;
            if (!utmParams) {
                updateUTMStatus('❌ Please enter UTM parameters');
                return;
            }
            
            const newUrl = `${window.location.origin}${window.location.pathname}?${utmParams}`;
            updateUTMStatus(`🔄 Redirecting with UTMs: ${utmParams}`);
            setTimeout(() => {
                window.location.href = newUrl;
            }, 1000);
        }
        
        function clearUTMs() {
            const cleanUrl = `${window.location.origin}${window.location.pathname}`;
            window.location.href = cleanUrl;
        }
        
        function updateUTMStatus(message) {
            const statusDiv = document.getElementById('utmStatus');
            statusDiv.textContent += `[${new Date().toLocaleTimeString()}] ${message}\\n`;
            statusDiv.scrollTop = statusDiv.scrollHeight;
        }
        
        // DataLayer Monitoring Functions
        function startDataLayerMonitoring() {
            if (dataLayerMonitor) return;
            
            const logDiv = document.getElementById('dataLayerLog');
            logDiv.textContent += `[${new Date().toLocaleTimeString()}] 📊 DataLayer monitoring started\\n`;
            
            dataLayerMonitor = setInterval(() => {
                if (window.dataLayer && window.dataLayer.length > originalDataLayer.length) {
                    const newEvents = window.dataLayer.slice(originalDataLayer.length);
                    newEvents.forEach(event => {
                        logDiv.textContent += `[${new Date().toLocaleTimeString()}] 📡 ${JSON.stringify(event, null, 2)}\\n`;
                        originalDataLayer.push(event);
                    });
                    logDiv.scrollTop = logDiv.scrollHeight;
                }
            }, 500);
        }
        
        function stopDataLayerMonitoring() {
            if (dataLayerMonitor) {
                clearInterval(dataLayerMonitor);
                dataLayerMonitor = null;
                document.getElementById('dataLayerLog').textContent += `[${new Date().toLocaleTimeString()}] ⏹️ DataLayer monitoring stopped\\n`;
            }
        }
        
        function clearDataLayerLog() {
            document.getElementById('dataLayerLog').textContent = '';
        }
        
        function sendTestEvent() {
            gtag('event', 'test_event', {
                test_parameter: 'ga4_testing_tool',
                timestamp: Date.now(),
                page_location: window.location.href
            });
            
            document.getElementById('dataLayerLog').textContent += `[${new Date().toLocaleTimeString()}] 🧪 Test event sent\\n`;
        }
        
        // Debug Mode Functions
        function enableDebugMode() {
            const currentUrl = new URL(window.location);
            currentUrl.searchParams.set('debug_mode', 'true');
            window.location.href = currentUrl.toString();
        }
        
        function openGA4DebugView() {
            window.open('https://analytics.google.com/analytics/web/#/debugview/a', '_blank');
        }
        
        // Initialize testing
        window.addEventListener('load', function() {
            // Check for UTM parameters
            const urlParams = new URLSearchParams(window.location.search);
            const utmParams = {};
            ['utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term', 'fbclid', 'gclid'].forEach(param => {
                if (urlParams.get(param)) {
                    utmParams[param] = urlParams.get(param);
                }
            });
            
            if (Object.keys(utmParams).length > 0) {
                updateUTMStatus(`✅ UTM parameters detected: ${JSON.stringify(utmParams, null, 2)}`);
            } else {
                updateUTMStatus('ℹ️ No UTM parameters in current URL');
            }
            
            // Start monitoring automatically
            setTimeout(startDataLayerMonitoring, 1000);
            
            // Update test results
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.textContent = `✅ Test tool loaded successfully\\n✅ GTM container: GTM-W5WXGDM9\\n✅ Consent Mode v2 initialized\\n${Object.keys(utmParams).length > 0 ? '✅ UTM parameters detected' : 'ℹ️ No UTMs in URL'}\\n✅ DataLayer monitoring active`;
        });
    </script>
</body>
</html>
